---
version: 1
kind: component
meta:
  name: nginxing
  brief: Nginx ingress Controller
  source:
      dir: ../../components/nginxing

requires:
  - kubernetes
  - helm
  - tiller
provides:
  - nginxing

parameters:
  - name: terraform.bucket.name
    env: STATE_BUCKET
  - name: terraform.bucket.region
    env: STATE_REGION
  - name: dns.domain
    env: TF_VAR_domain_name
  - name: cloud.kind
    env: CLOUD_KIND
  - name: component.wowza.namespace
  - name: component.wowza.name
  - name: component.nginxing
    parameters:
    - name:    name
      default: nginxing
      env:     TF_VAR_component
    - name:    version
      brief:   nginx-ingress version
      default: "0.11.0"
    - name:    image.repository
      default: quay.io/kubernetes-ingress-controller/nginx-ingress-controller
    - name:    image.pullPolicy
      default: IfNotPresent
    - name:    replicaCount
      default: 1
    - name:    urlPrefix
      default: svc
      env:     TF_VAR_url_prefix
    - name:    namespace
      default: nginx-ingress
      env:     TF_VAR_namespace
    - name:    chart
      value:   stable/nginx-ingress
      env:     CHART
    - name:    chart.version
      value:   0.11.1
      env:     CHART_VERSION
    - name:    bin.terraform
      value:   terraform-v0.11
      env:     terraform


outputs:
- name: component.nginxing.fqdn
  brief: FQDN of ingress
  fromTfVar: ingress_fqdn

templates:
  files: ["values.yaml.template"]

---
version: 1
kind: component
meta:
  name: nats
  brief: NATS messaging system
  version: 1.3.0
  maturity: stable
  licence: Apache License 2.0
  source:
    dir: ../../components/nats

requires:
  - kubernetes
  - ingress
provides:
  - nats

parameters:
- name: dns.domain
  env: DOMAIN_NAME
- name: component.ingress.protocol
- name: component.ingress.ssoFqdn
- name: component.nats
  parameters:
  - name: name
    value: ${dns.name}-${hub.componentName}
    env: COMPONENT_NAME
  - name: namespace
    value: nats
    env: NAMESPACE
  - name: port
    value: 4222
  - name: monitor.port
    value: 8222
  - name: replicas
    value: 1
  - name: version
    value: '1.3.0'
  - name: chart.version
    value: '2.0.1'
    env: CHART_VERSION
  - name: natsboard.image
    value: agilestacks/natsboard:latest
outputs:
- name:  component.nats.monitor.ingress
  value: ${component.nats.name}.${component.ingress.ssoFqdn}
- name:  component.nats.monitor.url
  value: ${component.ingress.protocol}://${component.nats.monitor.ingress}
- name:  component.minio.nats.enabled
  value: true
- name:  component.minio.nats.subject
  value: bucketevents
- name: component.minio.nats.client.fqdn
  value: ${component.nats.name}-nats-client.${component.nats.namespace}.svc.cluster.local:${component.nats.port}
templates:
  files:
  - "*.template"
  - "natsboard/*.template"

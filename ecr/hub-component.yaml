---
version: 1
kind: component
meta:
  name: ecr
  brief: ECR component
  source:
    dir: ../../components/ecr

requires:
  - aws
provides:
  - docker-registry

parameters:
- name: component.ecr
  parameters:
  - name:    name
    default: ecr
    env:     COMPONENT_NAME
  - name:    image_name
    env:     TF_VAR_image_name
  env:   TF_VAR_name
- name:  dns.domain
  brief: DNS domain
  kind: tech
  env:  DOMAIN_NAME
- name: component.postgresql
  parameters:
  - name:    name
    default: postgresql
    env:     COMPONENT_NAME
- name: terraform.bucket
  parameters:
  - name: name
    default: terraform.agilestacks.com
    env: BACKEND_BUCKET
  - name: region
    default: us-east-1
    env: BACKEND_REGION

outputs:
- name: component.ecr.image
  brief: Docker image of this component
  fromTfVar: repository_url
- name: component.ecr.registry_id
  brief: ECR registry id
  fromTfVar: registry_id
---
version: 1
kind: component
meta:
  name: efk
  brief: Elasticseach Fluentd and Kibana
  source:
    dir: ../../components/efk

requires:
  - kubernetes

provides:
  - efk

parameters:
  - name: component.ingress.ssoUrlPrefix
  - name: component.ingress.protocol
  - name: dns.domain
    brief: DNS domain
    kind: tech
    env: DOMAIN_NAME
  - name: component.efk
    parameters:
    - name:    name
      default: efk
      env:     COMPONENT_NAME
    - name:    namespace
      brief:   Kubernetes namespace to install into
      default: logs
      env:     NAMESPACE
    - name:    ingress.urlPrefix
      default:  logs
    - name:    ingress.kibanaUrlPrefix
      default: kibana

templates:
  files:
    - "*.template"

outputs:
  - name: component.efk.url
    brief: Kibana Dashboard
    value: ${component.ingress.protocol}://${component.efk.ingress.kibanaUrlPrefix}.${component.ingress.ssoUrlPrefix}.${dns.domain}
